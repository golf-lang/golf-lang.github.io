<!DOCTYPE html>
<html lang="en">

<head>
<!--__GOLF_REDIRECT__-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">

<title>Encryption: ciphers, digests, salt, IV and a hands-on guide</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="HandheldFriendly" content="True"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="canonical" href="https://rimstone-lang.com/article-encryption.html" />
<style>


body, html {
    font-family: Quicksand,monospace,Helvetica, Arial, sans-serif;
    line-height: 150%;
    font-size:16px;
}

body {
    padding-left:1vw;
    padding-right:1vw;
}
    
.ncode {
    letter-spacing: 0px;
    font-family: monospace;
    font-size:83%;
    display:inline-block;
    max-width:99%;
    min-width:90%;
    margin:0;
    padding:0;
    padding-left:5px;
    padding-top:3px;
    padding-bottom:3px;
    margin-bottom:8px;
    margin-top:8px;
    border: 2px solid #d6d6d6;
    background-color:#f5f7f4;
    white-space:nowrap;
}

.shcode {
    letter-spacing: 0px;
    font-family: monospace;
    font-size:83%;
    display:inline-block;
    max-width:99%;
    min-width:90%;
    margin:0;
    padding:0;
    padding-left:5px;
    padding-top:3px;
    padding-bottom:3px;
    margin-bottom:8px;
    margin-top:8px;
    border: 2px solid #d6d6d6;
    background-color:#f5f7f4;
    white-space:nowrap;
}

.sqlcode {
    letter-spacing: 0px;
    font-family: monospace;
    font-size:83%;
    display:inline-block;
    max-width:99%;
    min-width:90%;
    margin:0;
    padding:0;
    padding-left:5px;
    padding-top:3px;
    padding-bottom:3px;
    margin-bottom:8px;
    margin-top:8px;
    border: 2px solid #d6d6d6;
    background-color:#f5f7f4;
    white-space:nowrap;
}

.htmlcode {
    letter-spacing: 0px;
    font-family: monospace;
    font-size:83%;
    display:inline-block;
    max-width:99%;
    min-width:90%;
    margin:0;
    padding:0;
    padding-left:5px;
    padding-top:3px;
    padding-bottom:3px;
    margin-bottom:8px;
    margin-top:8px;
    border: 2px solid #d6d6d6;
    background-color:#f5f7f4;
    white-space:nowrap;
}

.code {
    letter-spacing: 0px;
    font-family: monospace;
    font-size:83%;
    display:inline-block;
    max-width:99%;
    min-width:90%;
    margin:0;
    padding:0;
    padding-left:5px;
    padding-top:3px;
    padding-bottom:3px;
    margin-bottom:8px;
    margin-top:8px;
    border: 2px solid #d6d6d6;
    background-color:#f5f7f4;
    white-space:nowrap;
}

/*Just like h1 but for pdf conversion it would be indented this way it's not*/
.vhub {
    display: block;
   font-size: 1.6em;
   margin-top: 0.63em;
   margin-bottom: 0.63em;
   margin-left: 0;
   margin-right: 0;
   font-weight: bold;
}

/*Just like h2 but for pdf conversion it would be indented this way it's not*/
.vsub {
    display: block;
   font-size: 1.25em;
   margin-top: 0.53em;
   margin-bottom: 0.53em;
   margin-left: 0;
   margin-right: 0;
   font-weight: bold;
}

ul {
  margin-left: 0.75vw;
  padding-left: 0;
}
li {
  margin-left: 0.75vw;
  padding-left: 0;
}

/* this must be last, as it overrides previous settings, for mobile */
@media (hover: none) {
a {
   display: inline-block;
   padding-top: 3px;
   padding-bottom: 2px;
}
body {
    padding-left:2vw;
    padding-right:2vw;
    letter-spacing: 1px;
}
}

/*The following is for code snippets that are highlighted by 2html vim*/
pre { overflow-x: scroll; margin:0; padding:0; font-family:monospace; }
.Identifier { color: #008b8b; }
.Statement { color: #af5f00; }
.PreProc { color: #5fd7ff; }
.Type { color: #005f00; }
.Comment { color: blue ; }
.Constant { color: #ff00ff; }
/*end of highlighted snippets*/

a {
    text-decoration:none;
    padding-bottom: 0px; 
    color:inherit;
    border-bottom: 2px solid #6cb8f0;
}
a:hover {
    text-decoration: none;
    color:black;
    border-bottom: 1px solid red;
}
/*do not underline links nor should they be active*/
pre a {
    text-decoration:none;
    color:black;
    border-bottom: none;
    pointer-events: none;
    cursor: default;
}


.golfSnippet {display:none;}

ul {
  list-style-type:square;
  list-style-position: outside;
}

</style>


</head>
<body>
<div id="google_translate_element" style='float:right'></div>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script>
function gg_copy(gt, eid, gc) {
  gt.textContent = eid.textContent;
  gt.select();
  document.execCommand("copy");
  gc.style.visibility="visible"
  setTimeout(()=>{ gc.style.visibility="hidden"; }, 1000);
}
function googleTranslateElementInit() {
   new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
}

</script>

<!--GOLFMENU13-->

<!--GOLFENDMENU13-->



<!--BEGVDOC90-->
<div class='vhub' style='margin-top:10px;margin-right:20px;text-align:left;background-color:white;'><a href='https://rimstone-lang.com' style='border-bottom:0px'><img src='https://rimstone-lang.com/rimstone.png'/></a></div><div class='vhub' style='margin-top:10px;'>Encryption: ciphers, digests, salt, IV and a hands-on guide</div><hr/><br/>
<br/><div class='vimg'><img class='imgs' src='encryption.jpg' alt='Golf'></img>
</div><br/>
<div class="vsub"><a id="What is encryption"></a>What is encryption</div>
Encryption is a method of turning data into an unusable form that can be made useful only by means of decryption. The purpose is to make data available solely to those who can decrypt it (i.e. make it usable). Typically, data needs to be encrypted to make sure it cannot be obtained in case of unauthorized access. It is the last line of defense after an attacker has managed to break through authorization systems and access control.<br/>
<br/>
This doesn't mean all data needs to be encrypted, because often times authorization and access systems may be enough, and in addition, there is a performance penalty for encrypting and decrypting data. If and when the data gets encrypted is a matter of application planning and risk assessment, and sometimes it is also a regulatory requirement, such as with HIPAA or GDPR.<br/>
<br/>
Data can be encrypted at-rest, such as on disk, or in transit, such as between two parties communicating over the Internet.<br/>
<br/>
Here you will learn how to encrypt and decrypt data using a password, also known as symmetrical encryption. This password must be known to both parties exchanging information.<br/>
<div class="vsub"><a id="Cipher, digest, salt, iterations, IV"></a>Cipher, digest, salt, iterations, IV</div>
To properly and securely use encryption, there are a few notions that need to be explained.<br/>
<br/>
A cipher is the algorithm used for encryption. For example, AES256 is a cipher. The idea of a cipher is what most people will think of when it comes to encryption.<br/>
<br/>
A digest is basically a hash function that is used to scramble and lengthen the password (i.e. the encryption key) before it's used by the cipher. Why is this done? For one, it creates a well randomized, uniform-length hash of a key that works better for encryption. It's also very suitable for "salting", which is the next one to talk about.<br/>
<br/>
The "salt" is a method of defeating so-called "rainbow" tables. An attacker knows that two hashed values will still look exactly the same if the originals were. However, if you add the salt value to hashing, then they won't. It's called "salt" because it's sort of mixed with the key to produce something different. Now, a rainbow table will attempt to match known hashed values with precomputed data in an effort to guess a password. Usually, salt is randomly generated for each key and stored with it. In order to match known hashes, the attacker would have to precompute rainbow tables for great many random values, which is generally not feasible.<br/>
<br/>
You will often hear about "iterations" in encryption. An iteration is a single cycle in which a key and salt are mixed in such a way to make guessing the key harder. This is done many times so to make it computationally difficult for an attacker to reverse-guess the key, hence "iterations" (plural). Typically, a minimum required number of iterations is 1000, but it can be different than that. If you start with a really strong password, generally you need less.<br/>
<br/>
IV (or "Initialization Vector") is typically a random value that's used for encryption of each message. Now, salt is used for producing a key based on a password. And IV is used when you already have a key and now are encrypting messages. The purpose of IV is to make the same messages appear differently when encrypted. Sometimes, IV also has a sequential component, so it's made of a random string plus a sequence that constantly increases. This makes "replay" attacks difficult, which is where attacker doesn't need to decrypt a message; but rather an encrypted message was "sniffed" (i.e. intercepted between the sender and receiver) and then replayed, hoping to repeat the action already performed. Though in reality, most high-level protocols already have a sequence in place, where each message has, as a part of it, an increasing packet number, so in most cases IV doesn't need it.<br/>
<div class="vsub"><a id="Encryption example"></a>Encryption example</div>
To run the examples here, create an application "enc" in a directory of its own (see <a href='https://rimstone-lang.com/mgrg.html'>mgrg</a> for more on Golf's program manager):<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_84' class=notranslate>
<span class="Statement">mkdir</span> enc_example
<span class="Statement">cd</span> enc_example
gg <span class="Special">-k</span> enc</pre>
<span id=rimstone_copied_84 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_84' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_84, code_84, rimstone_copied_84)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
To encrypt data use <a href='https://rimstone-lang.com/encrypt-data.html'>encrypt-data</a> statement. The simplest form is to encrypt a null-terminated string. Create a file "encrypt.golf" and copy this:<br/>
<div class='code'  style='position:relative;padding-right:16px;'>
<pre id='code_83' class=notranslate>
begin-handler /encrypt public
    set-string str = &quot;This contains a secret code, which is Open Sesame!&quot;
    // Encrypt
    encrypt-data str to enc_str password &quot;my_password&quot;
    print-out enc_str
    @
    // Decrypt
    decrypt-data enc_str password &quot;my_password&quot; to dec_str
    print-out dec_str
    @
end-handler</pre>
<span id=rimstone_copied_83 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_83' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_83, code_83, rimstone_copied_83)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
You can see the basic usage of encrypt-data and <a href='https://rimstone-lang.com/decrypt-data.html'>decrypt-data</a>. You supply data (original or encrypted), the password, and off you go. The data is encrypted and then decrypted, yielding the original. <br/>
<br/>
In the source code, a string variable "enc_str" (which is created as a "char *") will contain the encrypted version of "This contains a secret code, which is Open Sesame!" and "dec_str" will be the decrypted data which must be exactly the same.<br/>
<br/>
To run this code from command line, make the application first:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_87' class=notranslate>
gg <span class="Special">-q</span></pre>
<span id=rimstone_copied_87 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_87' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_87, code_87, rimstone_copied_87)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Then have Golf produce the bash code to run it - the request path is "/encrypt", which in our case is handled by function "void encrypt()" defined in source file "encrypt.golf". In Golf, these names always match, making it easy to write, read and execute code. Use "-r" option in <a href='https://rimstone-lang.com/gg.html'>gg</a> to specify the request path and get the code you need to run the program:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_90' class=notranslate>
gg <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/encrypt</span><span class="Statement">&quot;</span> <span class="Special">--silent-header</span> <span class="Special">--exec</span></pre>
<span id=rimstone_copied_90 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_90' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_90, code_90, rimstone_copied_90)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
You will get a response like this:<br/>
<div class='ncode' style='position:relative;padding-right:16px;'>
<pre id='code_82' class=notranslate>
72ddd44c10e9693be6ac77caabc64e05f809290a109df7cfc57400948cb888cd23c7e98e15bcf21b25ab1337ddc6d02094232111aa20a2d548c08f230b6d56e9
This contains a secret code, which is Open Sesame!</pre>
<span id=rimstone_copied_82 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_82' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_82, code_82, rimstone_copied_82)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
What you have here is the encrypted data, and then this encrypted data is decrypted using the same password. Unsurprisingly, the result matches the string you encrypted in the first place.<br/>
<br/>
Note that by default encrypt-data will produce encrypted value in a human-readable hexadecimal form, which means consisting of hexadecimal characters "0" to "9" and "a" to "f". This way you can store the encrypted data into a regular string. For instance it may go to a JSON document or into a VARCHAR column in a database, or pretty much anywhere else. However you can also produce a binary encrypted data. More on that in a bit.<br/>
<div class="vsub"><a id="Encrypt data into a binary result"></a>Encrypt data into a binary result</div>
In the previous example, the resulting encrypted data is in a human-readable hexadecimal form. You can also create binary encrypted data, which is not a human-readable string and is also shorter. To do that, use "binary" clause. Replace the code in "encrypt.golf" with:<br/>
<div class='code'  style='position:relative;padding-right:16px;'>
<pre id='code_86' class=notranslate>
begin-handler /encrypt public
    set-string str = &quot;This contains a secret code, which is Open Sesame!&quot;
    // Encrypt
    encrypt-data str to enc_str password &quot;my_password&quot; binary
    // Save the encrypted data to a file
    write-file &quot;encrypted_data&quot; from enc_str
    get-app directory to app_dir
    @Encrypted data written to file &lt;&lt;print-out app_dir&gt;&gt;/encrypted_data
    // Decrypt data
    decrypt-data enc_str password &quot;my_password&quot; binary to dec_str
    print-out dec_str
    @
end-handler</pre>
<span id=rimstone_copied_86 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_86' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_86, code_86, rimstone_copied_86)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
When you want to get binary encrypted data, you should get its length in bytes too, or otherwise you won't know where it ends, since it may contain null bytes in it. Use "output-length" clause for that purpose. In this code, the encrypted data in variable "enc_str" is written to file "encrypted_data", and the length written is "outlen" bytes. When a file is written without a path, it's always written in the application home directory (see <a href='https://rimstone-lang.com/directories.html'>directories</a>), so you'd use <a href='https://rimstone-lang.com/get-app.html'>get-app</a> to get that directory.<br/>
<br/>
When decrypting data, notice the use of "input-length" clause. It says how many bytes the encrypted data has. Obviously you can get that from "outlen" variable, where encrypt-data stored the length of encrypted data. When encryption and decryption are decoupled, i.e. running in separate programs, you'd make sure this length is made available.<br/>
<br/>
Notice also that when data is encrypted as "binary" (meaning producing a binary output), the decryption must use the same.<br/>
<br/>
Make the application:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_93' class=notranslate>
gg <span class="Special">-q</span></pre>
<span id=rimstone_copied_93 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_93' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_93, code_93, rimstone_copied_93)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Run it the same as before:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_96' class=notranslate>
gg <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/encrypt</span><span class="Statement">&quot;</span> <span class="Special">--silent-header</span> <span class="Special">--exec</span></pre>
<span id=rimstone_copied_96 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_96' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_96, code_96, rimstone_copied_96)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
The result is:<br/>
<div class='ncode' style='position:relative;padding-right:16px;'>
<pre id='code_85' class=notranslate>
Encrypted data written to file ~/.golf/apps/enc/app/encrypted_data
This contains a secret code, which is Open Sesame!</pre>
<span id=rimstone_copied_85 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_85' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_85, code_85, rimstone_copied_85)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
The decrypted data is exactly the same as the original.<br/>
<br/>
You can see the actual encrypted data written to the file by using "octal dump" ("od") Linux utility:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_99' class=notranslate>
od <span class="Special">-c</span> ~/.golf/apps/enc/app/encrypted_data</pre>
<span id=rimstone_copied_99 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_99' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_99, code_99, rimstone_copied_99)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
with the result like:<br/>
<div class='ncode' style='position:relative;padding-right:16px;'>
<pre id='code_88' class=notranslate>
$ od -c ~/.golf/apps/enc/app/encrypted_data
0000000   r 335 324   L 020 351   i   ; 346 254   w 312 253 306   N 005
0000020 370  \t   )  \n 020 235 367 317 305   t  \0 224 214 270 210 315
0000040   # 307 351 216 025 274 362 033   % 253 023   7 335 306 320
0000060 224   #   ! 021 252     242 325   H 300 217   #  \v   m   V 351
0000100</pre>
<span id=rimstone_copied_88 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_88' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_88, code_88, rimstone_copied_88)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
There you have it. You will notice the data is binary and it actually contains the null byte(s).<br/>
<div class="vsub"><a id="Encrypt binary data"></a>Encrypt binary data</div>
The data to encrypt in these examples is a string, i.e. null-delimited. You can encrypt binary data just as easily by specifying it whole (since Golf keeps track of how many bytes are there!), or specifying its length in "input-length" clause, for example copy this to "encrypt.golf":<br/>
<div class='code'  style='position:relative;padding-right:16px;'>
<pre id='code_89' class=notranslate>
begin-handler /encrypt public
    set-string str = &quot;This c\000ontains a secret code, which is Open Sesame!&quot;
    // Encrypt
    encrypt-data str to enc_str password &quot;my_password&quot; input-length 12
    print-out enc_str
    @
    // Decrypt
    decrypt-data enc_str password &quot;my_password&quot; to dec_str
    // Output binary data; present null byte as octal \000

    string-length dec_str to res_len
    start-loop repeat res_len use i start-with 0
        if-true dec_str[i] equal 0
            print-out &quot;\\000&quot;
        else-if
            print-format &quot;%c&quot;, dec_str[i]
        end-if
    end-loop
    @
end-handler</pre>
<span id=rimstone_copied_89 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_89' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_89, code_89, rimstone_copied_89)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
This will encrypt 12 bytes at memory location "enc_str" regardless of any null bytes. In this case that's "This c" followed by a null byte followed by "ontain" string, but it can be any kind of binary data, for example the contents of a JPG file.<br/>
<br/>
On the decrypt side, you'd obtain the number of bytes decrypted in "output-length" clause. Finally, the decrypted data is shown to be exactly the original and the null byte is presented in a typical octal representation.<br/>
<br/>
Make the application:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_101' class=notranslate>
gg <span class="Special">-q</span></pre>
<span id=rimstone_copied_101 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_101' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_101, code_101, rimstone_copied_101)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Run it the same as before:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_102' class=notranslate>
gg <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/encrypt</span><span class="Statement">&quot;</span> <span class="Special">--silent-header</span> <span class="Special">--exec</span></pre>
<span id=rimstone_copied_102 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_102' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_102, code_102, rimstone_copied_102)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
The result is:<br/>
<div class='ncode' style='position:relative;padding-right:16px;'>
<pre id='code_91' class=notranslate>
6bea45c2f901c0913c87fccb9b347d0a
This c\000ontai</pre>
<span id=rimstone_copied_91 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_91' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_91, code_91, rimstone_copied_91)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
The encrypted value is shorter because the data is shorter in this case too, and the result matches exactly the original.<br/>
<div class="vsub"><a id="Use any cipher or digest"></a>Use any cipher or digest</div>
The encryption used by default is <a href='https://en.wikipedia.org/wiki/Advanced_Encryption_Standard'>AES256</a> and <a href='https://en.wikipedia.org/wiki/SHA-2'>SHA256</a> hashing from the standard <a href='https://www.openssl.org/'>OpenSSL</a> library, both of which are widely used in cryptography. You can however use any available cipher and digest (i.e. hash) that is supported by OpenSSL (even the custom ones you provide).<br/>
<br/>
To see which algorithms are available, do this in command line:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_103' class=notranslate>
<span class="Comment">#get list of cipher providers</span>
openssl list <span class="Special">-cipher-algorithms</span>

<span class="Comment">#get list of digest providers</span>
openssl list <span class="Special">-digest-algorithms</span></pre>
<span id=rimstone_copied_103 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_103' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_103, code_103, rimstone_copied_103)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
These two will provide a list of cipher and digest (hash) algorithms. Some of them may be weaker than the default ones chosen by Golf, and others may be there just for backward compatibility with older systems. Yet others may be quite new and did not have enough time to be validated to the extent you may want them to be. So be careful when choosing these algorithms and be sure to know why you're changing the default ones. That said, here's an example of using Camellia-256 (i.e. "CAMELLIA-256-CFB1") encryption with "SHA3-512" digest. Replace the code in "encrypt.golf" with:<br/>
<div class='code'  style='position:relative;padding-right:16px;'>
<pre id='code_92' class=notranslate>
begin-handler /encrypt public
    set-string str = &quot;This contains a secret code, which is Open Sesame!&quot;
    // Encrypt data
    encrypt-data str to enc_str password &quot;my_password&quot; \
        cipher &quot;CAMELLIA-256-CFB1&quot; digest &quot;SHA3-512&quot;
    print-out enc_str
    @
    // Decrypt data
    decrypt-data enc_str password &quot;my_password&quot;  to dec_str \
        cipher &quot;CAMELLIA-256-CFB1&quot; digest &quot;SHA3-512&quot;
    print-out dec_str
    @
end-handler</pre>
<span id=rimstone_copied_92 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_92' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_92, code_92, rimstone_copied_92)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Make the application:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_76' class=notranslate>
gg <span class="Special">-q</span></pre>
<span id=rimstone_copied_76 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_76' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_76, code_76, rimstone_copied_76)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Run it:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_77' class=notranslate>
gg <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/encrypt</span><span class="Statement">&quot;</span> <span class="Special">--silent-header</span> <span class="Special">--exec</span></pre>
<span id=rimstone_copied_77 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_77' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_77, code_77, rimstone_copied_77)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
In this case the result is:<br/>
<div class='ncode' style='position:relative;padding-right:16px;'>
<pre id='code_94' class=notranslate>
f4d64d920756f7220516567727cef2c47443973de03449915d50a1d2e5e8558e7e06914532a0b0bf13842f67f0a268c98da6
This contains a secret code, which is Open Sesame!</pre>
<span id=rimstone_copied_94 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_94' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_94, code_94, rimstone_copied_94)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Again, you get the original data. Note you have to use the same cipher and digest in both encrypt-data and decrypt-data!<br/>
<br/>
You can of course produce the binary encrypted value just like before by using "binary" and "output-length" clauses.<br/>
<br/>
If you've got external systems that encrypt data, and you know which cipher and digest they use, you can match those and make your code interoperable. Golf uses standard OpenSSL library so chances are that other software may too.<br/>
<div class="vsub"><a id="Using salt"></a>Using salt</div>
To add a salt to encryption, use "salt" clause. You can generate random salt by using <a href='https://rimstone-lang.com/random-string.html'>random-string</a> statement (or <a href='https://rimstone-lang.com/random-crypto.html'>random-crypto</a> if there is a need). Here is the code for "encrypt.golf":<br/>
<div class='code'  style='position:relative;padding-right:16px;'>
<pre id='code_95' class=notranslate>
begin-handler /encrypt public
    set-string str = &quot;This contains a secret code, which is Open Sesame!&quot;
    // Get salt
    random-string to rs length 16
    // Encrypt data
    encrypt-data str to enc_str password &quot;my_password&quot; salt rs
    @Salt used is &lt;&lt;print-out rs&gt;&gt;, and the encrypted string is &lt;&lt;print-out enc_str&gt;&gt;
    // Decrypt data
    decrypt-data enc_str password &quot;my_password&quot; salt rs to dec_str
    print-out dec_str
    @
end-handler</pre>
<span id=rimstone_copied_95 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_95' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_95, code_95, rimstone_copied_95)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Make the application:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_78' class=notranslate>
gg <span class="Special">-q</span></pre>
<span id=rimstone_copied_78 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_78' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_78, code_78, rimstone_copied_78)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Run it a few times:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_79' class=notranslate>
gg <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/encrypt</span><span class="Statement">&quot;</span> <span class="Special">--silent-header</span> <span class="Special">--exec</span>
gg <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/encrypt</span><span class="Statement">&quot;</span> <span class="Special">--silent-header</span> <span class="Special">--exec</span>
gg <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/encrypt</span><span class="Statement">&quot;</span> <span class="Special">--silent-header</span> <span class="Special">--exec</span></pre>
<span id=rimstone_copied_79 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_79' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_79, code_79, rimstone_copied_79)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
The result:<br/>
<div class='ncode' style='position:relative;padding-right:16px;'>
<pre id='code_97' class=notranslate>
Salt used is VA9agPKxL9hf3bMd, and the encrypted string is 3272aa49c9b10cb2edf5d8a5e23803a5aa153c1b124296d318e3b3ad22bc911d1c0889d195d800c2bd92153ef7688e8d1cd368dbca3c5250d456f05c81ce0fdd
This contains a secret code, which is Open Sesame!
Salt used is FeWcGkBO5hQ1uo1A, and the encrypted string is 48b97314c1bc88952c798dfde7a416180dda6b00361217ea25278791c43b34f9c2e31cab6d9f4f28eea59baa70aadb4e8f1ed0709db81dff19f24cb7677c7371
This contains a secret code, which is Open Sesame!
Salt used is nCQClR0NMjdetTEf, and the encrypted string is f19cdd9c1ddec487157ac727b2c8d0cdeb728a4ecaf838ca8585e279447bcdce83f7f95fa53b054775be1bb2de3b95f2e66a8b26b216ea18aa8b47f3d177e917
This contains a secret code, which is Open Sesame!</pre>
<span id=rimstone_copied_97 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_97' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_97, code_97, rimstone_copied_97)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
As you can see, a random salt value (16 bytes long in this case) is generated for each encryption, and the encrypted value is different each time, even though the data being encrypted was the same! This makes it difficult to crack encryption like this.<br/>
<br/>
Of course, to decrypt, you must record the salt and use it exactly as you did when encrypting. In the code here, variable "rs" holds the salt. If you store the encrypted values in the database, you'd likely store the salt right next to it.<br/>
<div class="vsub"><a id="Initialization vector"></a>Initialization vector</div>
In practice, you wouldn't use a different salt value for each message. It creates a new key every time, and that can reduce performance. And there's really no need for it: the use of salt is to make each key (even the same ones) much harder to guess. Once you've done that, you might not need to do it again, or often.<br/>
<br/>
Instead, you'd use an IV (Initialization Vector) for each message. It's usually a random string that makes same messages appear different, and increases the computational cost of cracking the password. Here is the new code for "encrypt.golf":<br/>
<div class='code'  style='position:relative;padding-right:16px;'>
<pre id='code_98' class=notranslate>
begin-handler /encrypt public
    // Get salt
    random-string to rs length 16
    // Encrypt data
    start-loop repeat 10
        random-string to iv length 16
        encrypt-data &quot;The same message&quot; to enc_str password &quot;my_password&quot; salt rs iterations 2000 init-vector iv cache
        @The encrypted string is &lt;&lt;print-out enc_str&gt;&gt;
        // Decrypt data
        decrypt-data enc_str password &quot;my_password&quot; salt rs iterations 2000 init-vector iv to dec_str cache
        print-out dec_str
        @
    end-loop
end-handler</pre>
<span id=rimstone_copied_98 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_98' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_98, code_98, rimstone_copied_98)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Make the application:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_80' class=notranslate>
gg <span class="Special">-q</span></pre>
<span id=rimstone_copied_80 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_80' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_80, code_80, rimstone_copied_80)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
Run it a few times:<br/>
<div class="shcode" style='position:relative;padding-right:16px;'>
<pre id='code_81' class=notranslate>
gg <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/encrypt</span><span class="Statement">&quot;</span> <span class="Special">--silent-header</span> <span class="Special">--exec</span>
gg <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/encrypt</span><span class="Statement">&quot;</span> <span class="Special">--silent-header</span> <span class="Special">--exec</span>
gg <span class="Special">-r</span> <span class="Special">--req</span><span class="Statement">=</span><span class="Statement">&quot;</span><span class="Constant">/encrypt</span><span class="Statement">&quot;</span> <span class="Special">--silent-header</span> <span class="Special">--exec</span></pre>
<span id=rimstone_copied_81 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_81' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_81, code_81, rimstone_copied_81)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
The result may be:<br/>
<div class='ncode' style='position:relative;padding-right:16px;'>
<pre id='code_100' class=notranslate>
The encrypted string is 787909d332fd84ba939c594e24c421b00ba46d9c9a776c47d3d0a9ca6fccb1a2
The same message
The encrypted string is 7fae887e3ae469b666cff79a68270ea3d11b771dc58a299971d5b49a1f7db1be
The same message
The encrypted string is 59f95c3e4457d89f611c4f8bd53dd5fa9f8c3bbe748ed7d5aeb939ad633199d7
The same message
The encrypted string is 00f218d0bbe7b618a0c2970da0b09e043a47798004502b76bc4a3f6afc626056
The same message
The encrypted string is 6819349496b9f573743f5ef65e27ac26f0d64574d39227cc4e85e517f108a5dd
The same message
The encrypted string is a2833338cf636602881377a024c974906caa16d1f7c47c78d9efdff128918d58
The same message
The encrypted string is 04c914cd9338fcba9acb550a79188bebbbb134c34441dfd540473dd8a1e6be40
The same message
The encrypted string is 05f0d51561d59edf05befd9fad243e0737e4a98af357a9764cba84bcc55cf4d5
The same message
The encrypted string is ae594c4d6e72c05c186383e63c89d93880c8a8a085bf9367bdfd772e3c163458
The same message
The encrypted string is 2b28cdf5a67a5a036139fd410112735aa96bc341a170dafb56818dc78efe2e00
The same message</pre>
<span id=rimstone_copied_100 style='position:absolute;right:-14px;top:-30px; cursor: pointer;visibility:hidden;background:white;'>Copied!</span>
<textarea id='rimstonet_100' style='position: absolute;left: -500%;'></textarea>
<img src='https://rimstone-lang.com/rimstone-copy-small-1.png' id='rimstoneb' onclick='gg_copy(rimstonet_100, code_100, rimstone_copied_100)' style='position:absolute;right:0;top:0; cursor: pointer;opacity:0.5;'/>
</div><br/>
You can see that the same message appears different when encrypted, though when decrypted it's again the same. Of course, the password, salt, number of iterations, and init-vector must be the same for both encryption and decryption.<br/>
<br/>
Note the use of "cache" clause in encrypt-data and decrypt-data. It effectively caches the computed key (given password, salt, cipher/digest algorithms and number of iterations), so it's not computed each time through the loop. With "cache" the key is computed once, and then a different IV (in "init-vector" clause) is used for each message. <br/>
<br/>
If you want to occasionally rebuild the key, use "clear-cache" clause, which supplies a boolean. If true, the key is recomputed, otherwise it's left alone. See <a href='https://rimstone-lang.com/encrypt-data.html'>encrypt-data</a> for more on this.<br/>
<div class="vsub"><a id="Conclusion"></a>Conclusion</div>
You have learned how to encrypt and decrypt data using different ciphers, digests, salt and IV values in Golf. You can also create a human-readable encrypted value and a binary output, as well as encrypt both strings and binary values (like documents).<br/>
<!--ENDVDOC90-->
<br/><div style='width:100%;clear:both;'>
<hr/>
<!--GOLFFOOT77--><span style='font-size:80%'><a href="https://rimstone-lang.com/copyright.html">Copyright</a> (c) 2019-2025 Gliim LLC. All contents on this web site is "AS IS" without warranties or guarantees of any kind.</span>
</div><br/></body></html>


